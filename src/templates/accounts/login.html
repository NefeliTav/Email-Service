{% extends 'base.html' %}
{% load static %}
{% block content %}

<link rel="stylesheet" type='text/css' href="{% static 'css/login.css' %}">

  <div class="bg">
	<div class="columns ">
	  <div class="login-box">
		<form action="" onsubmit="login(); return false;">
			{% csrf_token %}
			<script>
				const login = () => {
					axios.defaults.xsrfCookieName = 'csrftoken';
					axios.defaults.xsrfHeaderName = 'X-CSRFToken';
					axios.post("/auth/login/",JSON.stringify(
						{
							'email':document.getElementById("email").value,
							'password':document.getElementById("password").value
						})
					).then((res)=>{
						if (res.data.errors) {
							const errors = res.data.errors
							Object.keys(errors).forEach((key) => {
								console.log(key, errors[key]);
								const message = document.getElementById(key + "-error");
								message.innerHTML =  errors[key];
							});
						}
						else {
							window.location.replace("../../home/");
						}
					})
					.catch((e)=>console.error(e));
				}
			</script>


		  <div class="signin" [hidden]="login">
			<h1 class="topline">Login</h1>
			<br />
			<div class="input-field">
			  <input type="text" 
			  id="email"
			  placeholder="@email.com" 
			  name="email" 
			  required  
			  style="background: url(https://res.cloudinary.com/www-santhoshthomas-xyz/image/upload/v1620796341/portfolio/name_1_rgo5hw.png) no-repeat 5%; background-size: 20px;z-index: 50;"
			  />
			</div>
			<div id="email-error" class="error"></div>
  
			<div class="input-field">
			  <input type="password"
			  id="password"
			  placeholder="Enter Password"
			  name="psw"
			  required
			  style ="background: url(https://res.cloudinary.com/www-santhoshthomas-xyz/image/upload/v1620796331/portfolio/lock_dnkpk8.png) no-repeat 5%; background-size: 20px;z-index: 50;"
			  />
			</div>
			<div id="password-error" class="error"></div>

			<div class="action">
			  <a href="../signup">I don't have an account</a>
			</div>
  
			<div class="login-box-button">
			  <button type="submit">
				<i class="fas fa-sign-in-alt"></i>
				LOG IN
			  </button>
			</div>
		  </div>
		</form>

	  </div>
{% endblock %}



