{% extends 'base.html' %}
{% load static %}
{% block content %}

<link rel="stylesheet" type='text/css' href="{% static 'css/login.css' %}">

  <div class="bg">
	<div class="columns ">
	  <div class="login-box">
		<form action="" onsubmit="signup(); return false;">
			{% csrf_token %}
			<script>
				const signup = () => {
					axios.defaults.xsrfCookieName = 'csrftoken';
					axios.defaults.xsrfHeaderName = 'X-CSRFToken';
					axios.post("/auth/signup/",JSON.stringify(
						{
							'first_name': document.getElementById("firstname").value,
							'last_name':document.getElementById("lastname").value,
							'email':document.getElementById("email").value,
							'phone':document.getElementById("phone").value,
							'date_of_birth':document.getElementById("date_of_birth").value,
							'password':document.getElementById("password").value,
							'confirm':document.getElementById("confirm").value
						})
					).then((res)=>{
						if (res.data.errors) {
							const errors = res.data.errors
							Object.keys(errors).forEach((key) => {
								console.log(key, errors[key]);
								const message = document.getElementById(key + "-error");
								message.innerHTML =  errors[key];
							});
						}
						else {
							window.location.replace("../../home/");
						}
					})
					.catch((e)=>console.error(e));
				}
			</script>
	
		<div class="signin" [hidden]="Signup">
		<h1 class="topline">Sign up</h1>
		<br />
	
		<div class="input-field">
			<input 
				type="text"
				id="firstname"
				placeholder="Enter First Name"
				name="first_name"
				required/>
		  </div>
		  <div id="firstname-error" class="error"></div>

		  <div class="input-field">
			<input 
				type="text"
				id="lastname"
				placeholder="Enter Last Name"
				name="last_name"
				required/>
		  </div>
		  <div id="last_name-error" class="error"></div>

		<!-- permanent placeholder in email -->
		  <div class="input-field">
			<input 
				type="text" 
				id="email"
				placeholder="@email.com" 
				name="email" 
				required/>
		  </div>
		  <div id="email-error" class="error"></div>
		  <div id="email2-error" class="error"></div>

		  <div class="input-field">
			<input 
				type="date" 
				id="date_of_birth"
				placeholder="Enter your Date of Birth" 
				name="date" 
				required/>
		  </div>
		  <div id="date_of_birth-error" class="error"></div>

		  <div class="input-field">
			<input 
				type="password" 
				id="password"
				placeholder="Enter your Password" 
				name="psw" 
				required/>
		  </div>
		  <div id="password-error" class="error"></div>

		  <div class="input-field">
			<input 
				type="password" 
				id="confirm"
				placeholder="Confirm your Password" 
				name="psw2" 
				required/>
		  </div>
		  <div id="confirm-error" class="error"></div>

		  <div class="action">
			<a href="../login">I already have an account</a>
		  </div>

	<div class="login-box-button">
		<button type="submit">
		  <i class="fas fa-sign-in-alt"></i>
		  SIGN UP
		</button>
	  </div>
</form>


{% endblock %}
