{% extends 'base.html' %}
{% block content %}
<h1>Sign up</h1>
<form action="" onsubmit="signup(); return false;">
	{% csrf_token %}
	<style>
		.error {
			color:red;
  			font-style: italic;
		}
	</style>
	<script>
		const signup = () => {
			axios.defaults.xsrfCookieName = 'csrftoken';
			axios.defaults.xsrfHeaderName = 'X-CSRFToken';
			axios.post("/auth/signup/",JSON.stringify(
				{
					'first_name': document.getElementById("firstname").value,
					'last_name':document.getElementById("lastname").value,
					'email':document.getElementById("email").value,
					'phone':document.getElementById("phone").value,
					'date_of_birth':document.getElementById("date_of_birth").value,
					'password':document.getElementById("password").value,
					'confirm':document.getElementById("confirm").value
				})
			).then((res)=>{
				if (res.data.errors) {
					const errors = res.data.errors
					Object.keys(errors).forEach((key) => {
						console.log(key, errors[key]);
						const message = document.getElementById(key + "-error");
						message.innerHTML =  errors[key];
					});
				}
			})
			.catch((e)=>console.error(e));
		}
	</script>
	<input
		type="text"
		id="firstname"
		placeholder="Enter First Name"
		name="first_name"
		required
	/><br/>
	<div id="firstname-error" class="error"></div>
	<input
		type="text"
		id="lastname"
		placeholder="Enter Last Name"
		name="last_name"
		required
	/><br/>
	<div id="lastname-error" class="error"></div>
	<!-- permanent placeholder in email -->
	<input 
		type="text" 
		id="email"
		placeholder="@email.com" 
		name="email" 
		required 
	/><br/>
	<div id="email-error" class="error"></div>
	<div id="email2-error" class="error"></div>

	<input 
		type="text" 
		id="phone"
		placeholder="Enter Phone" 
		name="tel" 
		required
	/><br/>
	<div id="phone-error" class="error"></div>
	<input
		type="date"
		id="date_of_birth"
		placeholder="Enter Date of Birth"
		name="date"
		required
	/><br/>
	<div id="date_of_birth-error" class="error"></div>
	<input
		type="password"
		id="password"
		placeholder="Enter Password"
		name="psw"
		required
	/><br/>
	<div id="password-error" class="error"></div>
	<input
		type="password"
		id="confirm"
		placeholder="Confirm Password"
		name="psw2"
		required
	/><br/>
	<div id="confirm-error" class="error"></div>

	<button type="submit" >Sign up</button>
</form>

{% endblock %}
